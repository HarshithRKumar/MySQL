--SELECT * FROM payments;
SELECT p.order_id, c.name,c.customer_id,p.payment_method,p.amount 
,CASE 
WHEN amount BETWEEN 0 and 5000 THEN 'D_grade'
WHEN amount BETWEEN 5001 and 10000 THEN 'C_grade'
WHEN amount BETWEEN 10001 and 20000 THEN 'B_grade'
ELSE 'A_garde'
END as payments_category
FROM customers c JOIN orders o on c.customer_id=o.customer_id 
JOIN payments p on p.order_id=o.order_id
WHERE payment_method in('UPI','Debit Card')
ORDER by amount DESC LIMIT 5;

